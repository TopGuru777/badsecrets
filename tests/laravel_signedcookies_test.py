from badsecrets import modules_loaded

LaravelSignedCookies = modules_loaded["laravel_signedcookies"]

tests = [
    (
        "base64:JRYMXfXXoPAmt3Q30rhxJUIf4ut7pMZOZIvF6WDCNiI=",
        "eyJpdiI6Ii9FOVVVNXMyclpZbFNnbmM5c2JDWlE9PSIsInZhbHVlIjoidlZhQlYxSk8xYU9oY2Z1dndvbmdxSmYxUE1FQTU5Zm1vWVE3azN5R1hwM0UxTFplSVZSVzFWOGVFK0d2Y3EyMVJYRWhZd1lvSGJ4M085L1dvV1RpZXk5UkNKaUNuOVcxZ0VZaVQ1bitPeEpoUGhjZkxReHJSSU44TE9ScEVvVlgiLCJtYWMiOiI0MzkyZDZkYjVjZjJmNGFlNjNjMDcyYzY1YmQwZmYwNjc4ZDM2NGM0MTZiOWViNDAxZWQxMDBhZTY3ZjI4YmIyIiwidGFnIjoiIn0%3D",
    ),
    (
        "base64:HyfSfw6tOF92gKtVaLaLO4053ArgEf7Ze0ndz0v487k=",
        "eyJpdiI6ImJ3TzlNRjV6bXFyVjJTdWZhK3JRZ1E9PSIsInZhbHVlIjoiQ3kxVDIwWkRFOE1sXC9iUUxjQ2IxSGx1V3MwS1BBXC9KUUVrTklReit0V2k3TkMxWXZJUE02cFZEeERLQU1PV1gxVForYkd1dWNhY3lpb2Nmb0J6YlNZR28rVmk1QUVJS3YwS3doTXVHSlhcL1JGY0t6YzhaaGNHR1duSktIdjF1elwvNXhrd1Q4SVlXMzBrbTV0MWk5MXFkSmQrMDJMK2F4cFRkV0xlQ0REVU1RTW5TNVMrNXRybW9rdFB4VitTcGQ0QlVlR3Vwam1IdERmaDRiMjBQS05VXC90SzhDMUVLbjdmdkUyMnQyUGtadDJHSEIyQm95SVQxQzdWXC9JNWZKXC9VZHI4Sll4Y3ErVjdLbXplTW4yK25pTGxMUEtpZVRIR090RlF0SHVkM0VaWU8yODhtaTRXcVErdUlhYzh4OXNacXJrVytqd1hjQ3FMaDhWeG5NMXFxVXB1b2V2QVFIeFwvakRsd1pUY0h6UUR6Q0UrcktDa3lFOENIeFR0bXIrbWxOM1FJaVpsTWZkSCtFcmd3aXVMZVRKYXl0RXN3cG5EMitnanJyV0xkU0E3SEUrbU0rUjlENU9YMFE0eTRhUzAyeEJwUTFsU1JvQ3d3UnIyaEJiOHA1Wmw1dz09IiwibWFjIjoiNmMzODEzZTk4MGRhZWVhMmFhMDI4MWQzMmRkNjgwNTVkMzUxMmY1NGVmZWUzOWU4ZTJhNjBiMGI5Mjg2NzVlNSJ9",
    ),
]

negative_tests = [
    "eyJpdiI6Ii9FOVVVNXMyclpZbFNnbmM5c2JDWlE9PSIsInZhbHVlIjoidlZhQlYxSk8xYU9oY2Z1dndvbmdxSmYxUE1FQTU5Zm1vWVE3az",
    "eyJpdiI6Ii9FOVVVNXMyclpZbFNnbmM5c2JDWlE9PSIsImhpdGhlcmUiOiJ2VmFCVjFKTzFhT2hjZnV2d29uZ3FKZjFQTUVBNTlmbW9ZUTdrM3lHWHAzRTFMWmVJVlJXMVY4ZUUrR3ZjcTIxUlhFaFl3WW9IYngzTzkvV29XVGlleTlSQ0ppQ245VzFnRVlpVDVuK094SmhQaGNmTFF4clJJTjhMT1JwRW9WWCIsIm1hYyI6IjQzOTJkNmRiNWNmMmY0YWU2M2MwNzJjNjViZDBmZjA2NzhkMzY0YzQxNmI5ZWI0MDFlZDEwMGFlNjdmMjhiYjIiLCJ0YWciOiIifQ==",
    "eyJpdiI6Ii9FOVVVNXMyclpZbFNnbmM5c2JDWlE9PSIsImhpdGhlcmUiOiJ2VmFCVjFKTzFhT2hjZnV2d29uZ3FKZjFQTUVBNTlmbW9ZUTdrM3lHWHAzRTFMWmVJVlJXMVY4ZUUrR3ZjcTIxUlhFaFl3WW9IYngzTzkvV29XVGlleTlSQ0ppQ245VzFnRVlpVDVuK094SmhQaGNmTFF4clJJTjhMT1JwRW9WWCIsIm1hYyI6IjMzOTJkNmRiNWNmMmY0YWU2M2MwNzJjNjViZDBmZjA2NzhkMzY0YzQxNmI5ZWI0MDFlZDEwMGFlNjdmMjhiYjIiLCJ0YWciOiIifQ==",
    "eyJpdiI6Ii9FOVVVNXMyclpZbFNnbmM5c2JDWlE9PScsInZhbHVlIjoidlZhQlYxSk8xYU9oY2Z1dndvbmdxSmYxUE1FQTU5Zm1vWVE3azN5R1hwM0UxTFplSVZSVzFWOGVFK0d2Y3EyMVJYRWhZd1lvSGJ4M085L1dvV1RpZXk5UkNKaUNuOVcxZ0VZaVQ1bitPeEpoUGhjZkxReHJSSU44TE9ScEVvVlgiLCJtYWMiOiI0MzkyZDZkYjVjZjJmNGFlNjNjMDcyYzY1YmQwZmYwNjc4ZDM2NGM0MTZiOWViNDAxZWQxMDBhZTY3ZjI4YmIyIiwidGFnIjoiIn0=",
]


def test_laravel():
    x = LaravelSignedCookies()
    for test in tests:
        found_key = x.check_secret(test[1])
        assert found_key
        assert found_key["secret"] == test[0]


def test_laravel_negative():
    x = LaravelSignedCookies()
    for test in negative_tests:
        found_key = x.check_secret(test[1])
        assert not found_key
